Overview
Это учебное соревнование по оффлайн-обучению политик (RL в форме контекстных бандитов) на основе классического датасета по e-mail маркетингу.

Start
15 days ago
Close
a day to go
Description
link
keyboard_arrow_up
1) Постановка задачи

Вам нужно построить политику

, которая, видя контекст пользователя

, назначает распределение вероятностей по действиям

, чтобы максимизировать вероятность визита.

Почему это не обычная классификация/регрессия?

В train мы наблюдаем пары

, где

— назначенное в эксперименте действие, а не ваше прогнозируемое действие.
Мы не видим контрфакты: что было бы с тем же пользователем при другом действии.
Обычная модель «предскажи visit» не отвечает на вопрос выбора действия и даёт смещённую оценку качества.
Нужен оффлайн-RL/контекстные бандиты: обучение политики и её оценка по логам с помощью методов важностного взвешивания (IPS/SNIPS), корректирующих разницу между вашей политикой и логирующей.
Ключевой объект — политика

, то есть вектор вероятностей по 3 действиям для каждого объекта.

2) Таргет

Reward: бинарная переменная visit (защумлённая), показывающая, был ли визит.
Цель: максимизировать ожидаемую вероятность визита при выборе действий по политике

.
Что должен сделать участник:

Построить модель(и), оценивающую полезность действий (например,

или непосредственно

).
Сформировать стохастическую политику

— вероятности по всем трём действиям, суммирующиеся в 1.
Сгенерировать submission.csv в требуемом формате (см. ниже).
Evaluation
link
keyboard_arrow_up
1) Метрика качества

Обозначения:


— контекст,

— действия (что реально делали в рассылке),

— reward,

— пропенсити логирующей политики (в нашем случае

),

— ваша политика (предсказываемый вектор вероятностей).
1.1. Self-Normalized IPS (SNIPS) — оценка значения политики



Где


Смысл: мы «перевзвешиваем» наблюдения тем сильнее, чем чаще ваша политика выбирала бы то же действие, что и логирующая.

1.2. Бенчмарк «лучшая статическая политика»

Рассмотрим три статические политики, выбирающие один фиксированный arm

всегда, и оценим их IPS-значения:


Тогда



1.3. Итоговый скор



Чем выше score, тем лучше.
Позитивный score означает, что ваша политика превосходит любую «один-arm» стратегию.
Лидерборд «Public»/«Private» считается на соответствующих подмножествах теста.
1.4. Примечания

Проверки валидности сабмита: каждая строка — три вероятности в

и их сумма ровно 1.
Не используйте segment как признак — это действие. В тесте его нет по определению.
2) Формат решения (submission)

Файл

Имя: submission.csv.
Колонки (строго в таком виде):
id — идентификатор из test.csv;
p_mens_email —

;
p_womens_email —

;
p_no_email —

.
Каждая строка — распределение вероятностей по трём действиям:


Пример

id,p_mens_email,p_womens_email,p_no_email
100001,0.10,0.80,0.10
100002,0.33,0.33,0.34
100003,0.70,0.10,0.20
...
Строгие требования к сабмиту

Строки id должны полностью покрывать test.csv и не содержать дубликатов. Вероятности — числовые, конечные, не NaN. Сумма по строке — ровно 1. Ни одна из колонок не должна отсутствовать/быть переименована.
